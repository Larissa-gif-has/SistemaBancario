from random import randint
import random 
saldo = 0
limite = 500
numero_saques = 0
limite_saques = 3
saque = 0
extrato = 0
agencia = '0001'
conta = []
usuarios = []
contas_geradas = []
while True:
    print("""[ 1 ] - DEPOSITAR
[ 2 ] - SACAR 
[ 3 ] - SALDO 
[ 4 ] - NOVO USÚARIO
[ 5 ] - CONSULTAR CONTA
[ 6 ] - EXCLUIR CONTA
[ 7 ] - SAIR
""")
    opcao = int(input('----- MENU -----:'))
    if opcao == 1:
        deposito = float(input('Qual valor voce quer depositar?'))
        extrato += deposito
        if deposito > 0:
            saldo += deposito
            print(f'Deposito efetuado com sucesso')
        else:
            print('Operação invalida. Tente novamente')
    elif opcao == 2:
        valor = float(input('Qual valor voce quer sacar?'))
        if valor < saldo and valor <= 500:
            saque += valor
        if valor == 500:
            numero_saques += 1
        excedeu_saldo = valor > saldo
        excedeu_limite = valor > limite
        excedeu_saques = numero_saques > limite_saques

        if excedeu_saldo:
            print('Operação falhou.Voce não tem saldo suficiente')
        elif excedeu_limite:
            print('Operação falhou. O valor do saque excede o limite')
        elif excedeu_saques:
            print('Operação falhou. Número máximo de saques excedido')
        elif valor > 0:
            saldo -= valor
            print(f'Saque no valor de R${valor:.2f} efetuado com sucesso ')
    elif opcao == 3:
        print(f"""---------- SALDO DA CONTA ----------
               R${saldo:.2f}""")
    elif opcao == 4:
         cpf = input('Informe seu CPF (somente números): ')
         for usuario in usuarios:
              if usuario['cpf'] == cpf:
                 cpf_existe = True
                 print('CPF já cadastrado! Tente novamente')
                 break
         else:
                nome = input('Irforme o nome completo:')
                data_nascimento = input('Informe a data de nascimento (dd-mm-aaaa):')
                while True:
                    numero_conta = str(random.randint(1000000,9999999))
                    if numero_conta not in contas_geradas:
                        contas_geradas.append(numero_conta)
                        break
                seis_digitos = numero_conta[:6]
                digito_final = numero_conta[6]
                conta = f'{seis_digitos}-{digito_final}'
                usuarios.append({'nome': nome,
                                 'data_nascimento': data_nascimento,
                                 'cpf': cpf,
                                 'agencia': agencia,
                                 'conta': conta
                                 })
                print('Usúario cadastrado com sucesso')
                print(f'Conta gerada {conta}')

    elif opcao == 5:
         consultar = input('Informe o CPF para consultar a conta:')
         for consult in usuarios:
            if consult['cpf'] == consultar:
                print(f'nome: {consult["nome"]}')
                print(f'CPF: {consult["cpf"]}')
                print(f'agencia: {consult["agencia"]}')
                print(f'conta: {consult["conta"]}')
                print('--------------------')
         else:
             print('CPF não existe ou foi excluído')

    elif opcao == 6:
        remover = input('informe o CPF para excluir a conta:')
        for remove in usuarios:
            if remove['cpf'] == remover:
                usuarios.remove(remove)
                print(f'Conta com o {remover} excluído com sucesso ')


    elif opcao == 7:
        print('Saindo...')
        break

print(f'Valor total sacado R${saque:.2f} reais')
print(f'Valor total depositado R${extrato:.2f} reais ')
